# Структурная схема веб-приложения "Система анализа продаж"

## 📋 Общая архитектура

```
┌─────────────────────────────────────────────────────────────────┐
│                    FRONTEND (React + TypeScript)                │
├─────────────────────────────────────────────────────────────────┤
│                         BACKEND (Supabase)                     │
├─────────────────────────────────────────────────────────────────┤
│                      DATABASE (PostgreSQL)                     │
└─────────────────────────────────────────────────────────────────┘
```

## 🏗️ Структура проекта

```
sales-analytics-app/
├── 📁 src/
│   ├── 📁 components/           # React компоненты
│   │   ├── 📁 auth/            # Аутентификация
│   │   ├── 📁 dashboard/       # Дашборд и аналитика
│   │   ├── 📁 data/           # Работа с данными
│   │   ├── 📁 layout/         # Макет приложения
│   │   └── 📁 upload/         # Загрузка файлов
│   ├── 📁 hooks/              # Custom React hooks
│   ├── 📁 lib/                # Библиотеки и утилиты
│   ├── 📁 types/              # TypeScript типы
│   ├── 📄 App.tsx             # Главный компонент
│   └── 📄 main.tsx            # Точка входа
├── 📁 supabase/
│   └── 📁 migrations/         # SQL миграции
├── 📁 dist/                   # Собранное приложение
└── 📄 package.json            # Зависимости проекта
```

## 🔧 Технологический стек

### Frontend
- **React 18** - UI библиотека
- **TypeScript** - Типизация
- **Tailwind CSS** - Стилизация
- **Vite** - Сборщик и dev-сервер
- **Recharts** - Графики и диаграммы
- **Lucide React** - Иконки

### Backend & Database
- **Supabase** - Backend-as-a-Service
- **PostgreSQL** - База данных
- **Row Level Security (RLS)** - Безопасность данных

### Обработка файлов
- **PapaParse** - Парсинг CSV
- **XLSX** - Работа с Excel
- **JSON** - Нативная поддержка

## 📊 Компонентная архитектура

```
App.tsx (Главный компонент)
├── 🔐 Аутентификация
│   ├── LoginForm.tsx
│   └── RegisterForm.tsx
├── 🎛️ Основной интерфейс
│   ├── Sidebar.tsx (Навигация)
│   ├── 📈 Dashboard (Аналитика)
│   │   ├── StatsCards.tsx
│   │   ├── FilterPanel.tsx
│   │   └── Charts.tsx
│   ├── 📤 Upload (Загрузка)
│   │   └── FileUpload.tsx
│   └── 📋 Data (Данные)
│       └── SalesTable.tsx
```

## 🔄 Поток данных

```
1. 📁 Файл (CSV/Excel/JSON)
   ↓
2. 🔄 FileUpload.tsx (Парсинг и валидация)
   ↓
3. 🎯 useSalesData.ts (Обработка и сохранение)
   ↓
4. 🗄️ Supabase (База данных)
   ↓
5. 📊 Analytics (Расчет метрик)
   ↓
6. 📈 Charts.tsx (Визуализация)
```

## 🔒 Система безопасности

```
┌─────────────────────────────────────────┐
│            Supabase Auth                │
├─────────────────────────────────────────┤
│         Row Level Security              │
├─────────────────────────────────────────┤
│    Политики доступа к данным            │
└─────────────────────────────────────────┘

Каждый пользователь видит только свои данные
```

## 📈 Модули аналитики

### 1. ABC Анализ
- Классификация товаров по выручке
- Категории: A (80%), B (15%), C (5%)

### 2. XYZ Анализ  
- Анализ стабильности спроса
- Категории: X (стабильный), Y (сезонный), Z (нерегулярный)

### 3. ABC-XYZ Анализ
- Комбинированный анализ
- 9 категорий с рекомендациями

### 4. Факторный анализ
- Влияние различных факторов на продажи

### 5. Структурный анализ
- Анализ по категориям, регионам, каналам

## 🎯 Основные функции

### Аутентификация
- ✅ Регистрация пользователей
- ✅ Вход в систему
- ✅ Управление сессиями

### Загрузка данных
- ✅ Поддержка CSV, Excel, JSON, TSV
- ✅ Автоматическое распознавание полей
- ✅ Предпросмотр данных
- ✅ Валидация и очистка

### Аналитика
- ✅ Интерактивные графики
- ✅ Комплексные анализы
- ✅ Фильтрация данных
- ✅ Экспорт результатов

### Визуализация
- ✅ Диаграммы и графики
- ✅ Таблицы с сортировкой
- ✅ Адаптивный дизайн
- ✅ Экспорт в Excel

## 🔗 API и хуки

### useAuth.ts
```typescript
- login(email, password)
- register(email, password, name)
- logout()
- user state management
```

### useSalesData.ts
```typescript
- loadUserData()
- addSalesData(data)
- clearAllData()
- updateFilters(filters)
- getAnalytics()
```

## 🗃️ Структура базы данных

### Таблица: sales_data
```sql
- id (uuid, PK)
- user_id (uuid, FK)
- date (date)
- product_name (text)
- product_id (text)
- category (text)
- quantity (integer)
- unit_price (numeric)
- revenue (numeric)
- cost_price (numeric)
- profit (numeric)
- profitability (numeric)
- discount (numeric)
- customer_type (text)
- region (text)
- sales_channel (text)
- created_at (timestamptz)
- updated_at (timestamptz)
```

## 🚀 Развертывание

### Локальная разработка
```bash
npm install
npm run dev
```

### Продакшн
```bash
npm run build
# Деплой на Netlify/Vercel
```

## 🔧 Конфигурация

### Переменные окружения
```env
VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_ANON_KEY=your_supabase_key
```

### Основные зависимости
- React 18.3.1
- TypeScript 5.5.3
- Supabase 2.39.0
- Tailwind CSS 3.4.1
- Recharts 2.12.0
- Vite 5.4.2

## 📱 Адаптивность

```
📱 Mobile (320px+)
├── Вертикальная навигация
├── Упрощенные графики
└── Сжатые таблицы

💻 Desktop (1024px+)
├── Боковая навигация
├── Полные графики
└── Расширенные таблицы
```

## 🎨 UI/UX принципы

- **Минимализм** - Чистый интерфейс
- **Интуитивность** - Понятная навигация
- **Производительность** - Быстрая загрузка
- **Доступность** - Поддержка скринридеров
- **Отзывчивость** - Адаптивный дизайн

## 🔄 Жизненный цикл данных

1. **Загрузка** → Парсинг файлов
2. **Валидация** → Проверка корректности
3. **Преобразование** → Нормализация данных
4. **Сохранение** → Запись в БД
5. **Анализ** → Расчет метрик
6. **Визуализация** → Отображение результатов
7. **Экспорт** → Выгрузка отчетов